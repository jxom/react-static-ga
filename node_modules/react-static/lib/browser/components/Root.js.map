{"version":3,"sources":["../../../src/browser/components/Root.js"],"names":["DefaultPath","render","DefaultRouter","children","basepath","RouterHook","plugins","sync","ResolvedRouter","Root","props","staticInfo","process","env","REACT_STATIC_ENV","path","sharedData","sharedHashesByProp","templateIndex","routeInfoByPath","Object","keys","forEach","propKey","sharedDataByHash","disableScroller","autoScrollToTop","autoScrollToHash","scrollToTopDuration","scrollToHashDuration","scrollToHashOffset","scrollerProps","Wrapper","React","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Router as ReachRouter } from '@reach/router'\n\n//\nimport {\n  routeInfoByPath,\n  sharedDataByHash,\n  registerTemplateForPath,\n  plugins,\n} from '../'\nimport { getBasePath, makeHookReducer } from '../utils'\nimport ErrorBoundary from './ErrorBoundary'\nimport HashScroller from './HashScroller'\nimport { withStaticInfo } from './StaticInfo'\n\nconst DefaultPath = ({ render }) => render\n\nconst DefaultRouter = ({ children, basepath }) => (\n  <ReachRouter basepath={basepath}>\n    <DefaultPath default render={children} />\n  </ReachRouter>\n)\n\nconst RouterHook = makeHookReducer(plugins, 'Router', { sync: true })\nconst ResolvedRouter = RouterHook(DefaultRouter)\n\nconst Root = withStaticInfo(\n  class Root extends React.Component {\n    static defaultProps = {\n      disableScroller: false, // TODO:v6 document this!\n      autoScrollToTop: true,\n      autoScrollToHash: true,\n      scrollToTopDuration: 0,\n      scrollToHashDuration: 800,\n      scrollToHashOffset: 0,\n    }\n    constructor(props) {\n      super()\n      const { staticInfo } = props\n      if (process.env.REACT_STATIC_ENV === 'production' && staticInfo) {\n        const {\n          path,\n          sharedData,\n          sharedHashesByProp,\n          templateIndex,\n        } = staticInfo\n\n        // Hydrate routeInfoByPath with the embedded routeInfo\n        routeInfoByPath[path] = staticInfo\n\n        // Hydrate sharedDataByHash with the embedded routeInfo\n        Object.keys(sharedHashesByProp).forEach(propKey => {\n          sharedDataByHash[sharedHashesByProp[propKey]] = sharedData[propKey]\n        })\n\n        // In SRR and production, synchronously register the templateIndex for the\n        // initial path\n        registerTemplateForPath(path, templateIndex)\n      }\n    }\n    render() {\n      const {\n        children,\n        disableScroller,\n        autoScrollToTop,\n        autoScrollToHash,\n        scrollToTopDuration,\n        scrollToHashDuration,\n        scrollToHashOffset,\n        staticInfo,\n      } = this.props\n\n      const scrollerProps = {\n        autoScrollToTop,\n        autoScrollToHash,\n        scrollToTopDuration,\n        scrollToHashDuration,\n        scrollToHashOffset,\n      }\n\n      let Wrapper = ({ children }) => children\n\n      const basepath = getBasePath()\n\n      // Add the scroller if not disabled\n      if (!disableScroller) {\n        Wrapper = ({ children }) => (\n          <HashScroller {...scrollerProps}>{children}</HashScroller>\n        )\n      }\n\n      return (\n        <ErrorBoundary>\n          <Wrapper>\n            <ResolvedRouter basepath={basepath} staticInfo={staticInfo}>\n              {children}\n            </ResolvedRouter>\n          </Wrapper>\n        </ErrorBoundary>\n      )\n    }\n  }\n)\n\nexport default Root\n"],"file":"Root.js"}