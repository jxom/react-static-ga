{"version":3,"sources":["../../../src/browser/utils/Visibility.js"],"names":["document","require","IntersectionObserver","POLL_INTERVAL","list","Map","onVisible","element","callback","get","io","window","entries","forEach","entry","target","isIntersecting","intersectionRatio","unobserve","disconnect","observe","set"],"mappings":";;;;;;;;;;;;;AAAA,IAAI,OAAOA,QAAP,KAAoB,WAAxB,EAAqC;AACnC;AACAC,EAAAA,OAAO,CAAC,uBAAD,CAAP,CAFmC,CAInC;AACA;;;AACAC,EAAAA,oBAAoB,CAACC,aAArB,GAAqC,IAArC;AACD;;AAED,IAAMC,IAAI,GAAG,IAAIC,GAAJ,EAAb;;AAEe,SAASC,SAAT,CAAmBC,OAAnB,EAA4BC,QAA5B,EAAsC;AACnD,MAAIJ,IAAI,CAACK,GAAL,CAASF,OAAT,CAAJ,EAAuB;AACrB;AACD;;AACD,MAAMG,EAAE,GAAG,IAAIC,MAAM,CAACT,oBAAX,CAAgC,UAAAU,OAAO,EAAI;AACpDA,IAAAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,KAAK,EAAI;AACvB;AACA,UACEP,OAAO,KAAKO,KAAK,CAACC,MAAlB,KACCD,KAAK,CAACE,cAAN,IAAwBF,KAAK,CAACG,iBAAN,GAA0B,CADnD,CADF,EAGE;AACAP,QAAAA,EAAE,CAACQ,SAAH,CAAaX,OAAb;AACAG,QAAAA,EAAE,CAACS,UAAH;AAEAX,QAAAA,QAAQ;AACT;AACF,KAXD;AAYD,GAbU,CAAX;AAcAE,EAAAA,EAAE,CAACU,OAAH,CAAWb,OAAX;AACAH,EAAAA,IAAI,CAACiB,GAAL,CAASd,OAAT,EAAkB,IAAlB;AACD;;;;;;;;;;;;;0BAtBKH,I;0BAEkBE,S","sourcesContent":["if (typeof document !== 'undefined') {\n  // Polyfill that shiz!\n  require('intersection-observer')\n\n  // Do manual polling for intersections every second. This isn't very fast\n  // but should handle most edge cases for now\n  IntersectionObserver.POLL_INTERVAL = 1000\n}\n\nconst list = new Map()\n\nexport default function onVisible(element, callback) {\n  if (list.get(element)) {\n    return\n  }\n  const io = new window.IntersectionObserver(entries => {\n    entries.forEach(entry => {\n      // Edge doesn't support isIntersecting. intersectionRatio > 0 works as a fallback\n      if (\n        element === entry.target &&\n        (entry.isIntersecting || entry.intersectionRatio > 0)\n      ) {\n        io.unobserve(element)\n        io.disconnect()\n\n        callback()\n      }\n    })\n  })\n  io.observe(element)\n  list.set(element, true)\n}\n"],"file":"Visibility.js"}